import{r as o,j as e,A as S,q as C,s as c,P as w,u as k,S as D,t as E,D as I,v as A,w as F,x as O,y as N}from"./vendor-24ffecde.js";import{v as R,u as B,M as P}from"./constants-d6b66379.js";const T=({onImport:p})=>{const[s,d]=o.useState(null),[m,n]=o.useState([]),h=async()=>{const r=await(await fetch("/macro-roller/imports/pf2e.json")).json();r.sort((i,g)=>i.name.localeCompare(g.name));const x=r.map(i=>({...i,id:R()}));n(x)},l=a=>{s&&p(s)};return o.useEffect(()=>{h()},[]),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx(S,{id:"macro-import-autocomplete",sx:{width:300},options:m,value:s,onChange:(a,r)=>{d(r)},autoHighlight:!0,getOptionLabel:a=>a.name,renderInput:a=>e.jsx(C,{...a,label:"PF2e Creature"}),renderOption:(a,r)=>o.createElement("li",{...a,key:r.id},r.name)}),e.jsx(c,{variant:"outlined",disabled:!s,onClick:l,children:"Import"})]}),e.jsx("div",{children:s&&e.jsx(w,{elevation:6,sx:{padding:"1rem",whiteSpace:"pre-wrap",wordBreak:"break-word",textAlign:"start",fontSize:"1.25rem"},children:s.macro})})]})},G=()=>{const{createMacro:p}=B(P),[s,d]=o.useState(""),[m,n]=o.useState(""),[h,l]=o.useState(!1),[a,r]=o.useState(!1),[x,i]=o.useState(""),g=k(),f=t=>{d(t.target.value)},j=t=>{n(t.target.value)},v=t=>{n("")},b=t=>{r(!0),i(t)},M=t=>{t.preventDefault();try{const u=p(s,m);g(`/macro/${u.macroId}`)}catch(u){u instanceof Error&&b(u.message)}},y=t=>{d(t.name),n(t.macro)};return o.useEffect(()=>{document.title="Macro Roller"},[]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{style:{display:"grid",rowGap:"1rem",gridTemplateColumns:"1fr",paddingBottom:"1.5rem"},children:[e.jsx(C,{label:"Name",fullWidth:!0,value:s,onChange:f}),e.jsx(C,{label:"Content",multiline:!0,fullWidth:!0,value:m,onChange:j,minRows:5,maxRows:15})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c,{variant:"contained",type:"submit",children:"Create Macro"}),e.jsx(c,{variant:"outlined",color:"error",onClick:v,children:"Clear"})]})]}),e.jsx(D,{open:a,autoHideDuration:5e3,onClose:()=>r(!1),children:e.jsx(E,{severity:"error",children:x})}),e.jsxs(I,{open:h,onClose:()=>l(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(A,{children:e.jsx(F,{id:"alert-dialog-description",children:"Do you really want to clear the current macro?"})}),e.jsxs(O,{children:[e.jsx(c,{onClick:()=>l(!1),children:"No"}),e.jsx(c,{onClick:()=>{n(""),l(!1)},autoFocus:!0,children:"Yes"})]})]})]}),e.jsx(N,{sx:{margin:"1rem"},children:"PF2e Import"}),e.jsx(T,{onImport:y})]})};export{G as default};
