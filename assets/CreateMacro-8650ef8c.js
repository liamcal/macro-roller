import{r as o,j as e,A as S,q as C,s as c,P as w,u as k,S as D,t as E,D as I,v as A,w as F,x as O,y as N}from"./vendor-ead14d25.js";import{v as B,u as R,M as P}from"./constants-a070eb73.js";const T=({onImport:p})=>{const[s,d]=o.useState(null),[m,n]=o.useState([]),h=async()=>{const r=await(await fetch("/macro-roller/imports/pf2e.json")).json();r.sort((i,g)=>i.name.localeCompare(g.name));const x=r.map(i=>({...i,id:B()}));n(x)},l=t=>{s&&p(s)};return o.useEffect(()=>{h()},[]),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx(S,{id:"macro-import-autocomplete",sx:{width:300},options:m,value:s,onChange:(t,r)=>{d(r)},autoHighlight:!0,getOptionLabel:t=>t.name,renderInput:t=>e.jsx(C,{...t,label:"PF2e Creature"}),renderOption:(t,r)=>o.createElement("li",{...t,key:r.id},r.name)}),e.jsx(c,{variant:"outlined",disabled:!s,onClick:l,children:"Import"})]}),e.jsx("div",{children:s&&e.jsx(w,{elevation:6,sx:{padding:"1rem",whiteSpace:"pre-wrap",wordBreak:"break-word",textAlign:"start",fontSize:"1.25rem"},children:s.macro})})]})},G=()=>{const{createMacro:p}=R(P),[s,d]=o.useState(""),[m,n]=o.useState(""),[h,l]=o.useState(!1),[t,r]=o.useState(!1),[x,i]=o.useState(""),g=k(),j=a=>{d(a.target.value)},f=a=>{n(a.target.value)},v=a=>{n("")},b=a=>{r(!0),i(a)},y=a=>{a.preventDefault();try{const u=p(s,m);g(`/macro/${u.macroId}`)}catch(u){u instanceof Error&&b(u.message)}},M=a=>{d(a.name),n(a.macro)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{style:{display:"grid",rowGap:"1rem",gridTemplateColumns:"1fr",paddingBottom:"1.5rem"},children:[e.jsx(C,{label:"Name",fullWidth:!0,value:s,onChange:j}),e.jsx(C,{label:"Content",multiline:!0,fullWidth:!0,value:m,onChange:f,minRows:5,maxRows:15})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c,{variant:"contained",type:"submit",children:"Create Macro"}),e.jsx(c,{variant:"outlined",color:"error",onClick:v,children:"Clear"})]})]}),e.jsx(D,{open:t,autoHideDuration:5e3,onClose:()=>r(!1),children:e.jsx(E,{severity:"error",children:x})}),e.jsxs(I,{open:h,onClose:()=>l(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(A,{children:e.jsx(F,{id:"alert-dialog-description",children:"Do you really want to clear the current macro?"})}),e.jsxs(O,{children:[e.jsx(c,{onClick:()=>l(!1),children:"No"}),e.jsx(c,{onClick:()=>{n(""),l(!1)},autoFocus:!0,children:"Yes"})]})]})]}),e.jsx(N,{sx:{margin:"1rem"},children:"PF2e Import"}),e.jsx(T,{onImport:M})]})};export{G as default};
